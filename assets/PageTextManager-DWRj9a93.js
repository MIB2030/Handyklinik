import{s as p,j as e}from"./index-RAj48Hce.js";import{r as t}from"./react-vendor-b3UjsJu-.js";import{s as f,R as k,V as T,z as W,J as _}from"./icons-CQN5Kxvf.js";import"./supabase-D5NMW07i.js";const C={why_us:"Warum Wir - Hauptsektion",why_us_features:"Warum Wir - Features",why_us_card:"Warum Wir - Detailkarte",services:"Services Sektion",hero:"Hero Bereich"};function F(){const[i,d]=t.useState([]),[j,u]=t.useState(!0),[x,h]=t.useState(null),[m,n]=t.useState(""),[l,v]=t.useState(!0),c=t.useRef(null);t.useEffect(()=>{w()},[]);const w=async()=>{u(!0);const{data:s,error:a}=await p.from("page_texts").select("*").order("section").order("order_index");a?console.error("Error loading texts:",a):s&&d(s),u(!1)},y=async s=>{h(s.id);const{error:a}=await p.from("page_texts").update({value:s.value,updated_at:new Date().toISOString()}).eq("id",s.id);a?(console.error("Error saving text:",a),n("Fehler beim Speichern!")):(n("Text erfolgreich gespeichert!"),g(),setTimeout(()=>n(""),3e3)),h(null)},g=()=>{if(c.current){const s=new Date().getTime();c.current.src=`/?t=${s}`}},N=()=>{v(!l)},b=(s,a)=>{d(i.map(r=>r.id===s?{...r,value:a}:r))},S=i.reduce((s,a)=>(s[a.section]||(s[a.section]=[]),s[a.section].push(a),s),{});return j?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(f,{className:"w-8 h-8 animate-spin text-blue-600"})}):e.jsxs("div",{className:"h-full",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Webseiten-Texte verwalten"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Bearbeiten Sie alle Textpassagen Ihrer Webseite"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:g,className:"flex items-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:"Vorschau aktualisieren"})]}),e.jsxs("button",{onClick:N,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l?e.jsx(T,{className:"w-4 h-4"}):e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:l?"Vorschau ausblenden":"Vorschau einblenden"})]})]})]})}),m&&e.jsx("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg text-green-800",children:m}),e.jsxs("div",{className:"flex gap-6 ",children:[l&&e.jsx("div",{className:"w-1/2 sticky top-6 self-start",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",style:{height:"calc(100vh - 200px)"},children:[e.jsxs("div",{className:"bg-gray-800 text-white px-4 py-3 flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Live-Vorschau"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Hauptseite"})]}),e.jsx("iframe",{ref:c,src:"/",className:"w-full h-full border-0",title:"Website Preview",style:{height:"calc(100% - 50px)"}})]})}),e.jsxs("div",{className:`space-y-8 ${l?"w-1/2":"w-full"}`,children:[Object.entries(S).map(([s,a])=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4 pb-2 border-b border-gray-200",children:C[s]||s}),e.jsx("div",{className:"space-y-6",children:a.map(r=>e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-1",children:r.key}),r.description&&e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:r.description})]}),e.jsx("button",{onClick:()=>y(r),disabled:x===r.id,className:"ml-4 flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:x===r.id?e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Speichern..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4"}),e.jsx("span",{children:"Speichern"})]})})]}),r.value.length>200?e.jsx("textarea",{value:r.value,onChange:o=>b(r.id,o.target.value),rows:6,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-sans text-sm"}):e.jsx("input",{type:"text",value:r.value,onChange:o=>b(r.id,o.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]},r.id))})]},s)),i.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Keine Texte gefunden."})})]})]})]})}export{F as default};
