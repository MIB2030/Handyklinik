import{j as s,H as T,F as S}from"./index-B3LTBj-0.js";import{r as c}from"./react-vendor-CyQtAcHN.js";import{q as w}from"./icons-D7vnYvoJ.js";const d={apiUrl:"https://www.it-recht-kanzlei.de/api",apiToken:"YOUR_API_TOKEN_HERE",shopId:"YOUR_SHOP_ID_HERE",endpoints:{impressum:"/rechtstexte/impressum",datenschutz:"/rechtstexte/datenschutz",agb:"/rechtstexte/agb"},cacheExpiration:24*60*60*1e3,isConfigured(){return!!(this.apiUrl&&this.apiToken!=="YOUR_API_TOKEN_HERE"&&this.shopId!=="YOUR_SHOP_ID_HERE")},enabled:!0},h="legal_text_",u="legal_fallback_";class E{async fetchFromApi(t){if(!d.isConfigured())return null;try{const e=t.split("/").pop()||"impressum",r=`${d.apiUrl}${t}?token=${d.apiToken}&shopid=${d.shopId}`,a=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)return null;const n=await a.json();return n.error?null:{content:n.content||n||"",lastUpdated:n.lastUpdated||new Date().toISOString()}}catch{return null}}getCachedText(t){try{const e=localStorage.getItem(h+t);if(!e)return null;const r=JSON.parse(e);return Date.now()-r.cachedAt>legalApiConfig.cacheExpiration?null:{content:r.content,lastUpdated:r.lastUpdated}}catch(e){return console.error("Cache read error:",e),null}}setCachedText(t,e){try{const r={...e,cachedAt:Date.now()};localStorage.setItem(h+t,JSON.stringify(r)),localStorage.setItem(u+t,JSON.stringify(e))}catch(r){console.error("Cache write error:",r)}}getFallbackText(t){try{const e=localStorage.getItem(u+t);return e?JSON.parse(e):null}catch(e){return console.error("Fallback read error:",e),null}}async getLegalText(t){const e=this.getCachedText(t);if(e)return e;const r=legalApiConfig.endpoints[t],a=await this.fetchFromApi(r);return a?(this.setCachedText(t,a),a):this.getFallbackText(t)}setFallbackText(t,e){const r={content:e,lastUpdated:new Date().toISOString()};localStorage.setItem(u+t,JSON.stringify(r))}clearCache(t){t?localStorage.removeItem(h+t):["impressum","datenschutz","agb"].forEach(e=>{localStorage.removeItem(h+e)})}async refreshAllTexts(){this.clearCache(),await Promise.all([this.getLegalText("impressum"),this.getLegalText("datenschutz"),this.getLegalText("agb")])}}const m=new E;function I(l,t){const[e,r]=c.useState(null),[a,n]=c.useState(!0),[g,x]=c.useState(null),[f,p]=c.useState(null);return c.useEffect(()=>{let i=!0;return(async()=>{try{n(!0),x(null),m.setFallbackText(l,t);const o=await m.getLegalText(l);if(!i)return;o?(r(o.content),p(o.lastUpdated)):(r(t),p(null))}catch(o){if(!i)return;console.error("Error loading legal text:",o),x("Fehler beim Laden der Rechtstexte"),r(t)}finally{i&&n(!1)}})(),()=>{i=!1}},[l,t]),{content:e,isLoading:a,error:g,lastUpdated:f}}function y({type:l,title:t,fallbackContent:e}){const r=typeof e=="string"?e:"",{content:a,isLoading:n,error:g}=I(l,r);return s.jsxs("div",{className:"min-h-screen bg-white",children:[s.jsx(T,{}),s.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[s.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-8",children:t}),n&&s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx(w,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-600",children:"Lade rechtliche Hinweise..."})]})}),!n&&a&&s.jsx("div",{className:"prose prose-lg max-w-none",children:a.startsWith("<")?s.jsx("div",{dangerouslySetInnerHTML:{__html:a}}):e}),!n&&!a&&e&&s.jsx("div",{className:"prose prose-lg max-w-none",children:e})]}),s.jsx(S,{})]})}export{y as L};
